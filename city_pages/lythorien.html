<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lythorien</title>
  <link rel="stylesheet" href="../stylesheet.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <style>
    .notes textarea {
      width: 100%;
      height: 250px;
      background-color: #1A1A1D;
      color: #E0D8B0;
      border: 1px solid #3A3A3F;
      border-radius: 5px;
      padding: 15px;
      font-family: 'Merriweather', serif;
      font-size: 1em;
      resize: vertical;
    }

  </style>
</head>
<body>
  <header>
    <h1>The Ardent Empire</h1>
    <nav>
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../players.html">Player Characters</a></li>
        <li><a href="../cities.html">Locations</a></li>
        <li><a href="../map/map.html">Map</a></li>
        <li><a href="../travel-calculator.html">Travel calc</a></li>
        <li><a href="../timeline.html">Timeline</a></li>
      </ul>
    </nav>
  </header>

  <div class="city-banner">
    <h1>Lythorien</h1>
    <p><em>The City of Whispers</em></p>
  </div>

  <div class="section">
    <h2>Lore</h2>
    <p>Lythorien, the "City of Whispers," is an isolated and enigmatic city built deep within the <strong>White-Lion-Woods</strong>. It was founded by the reclusive archmage Lythor, who built it atop a massive, dormant <strong>Starlight Crystal</strong> to serve as a bastion of hidden knowledge.</p>
    
    <p><strong>History & Governance:</strong> The city is governed by the <strong>Arcane Council</strong>, a triumvirate of powerful mages led by the enigmatic <strong>Archmage Danma</strong>. The city's most defining feature is the <strong>Whispering Sickness</strong>, a magical ailment that slowly steals a person's voice, only to have their lost words echo eerily through the city's alleys days or weeks later.</p>
    
    <p><strong>Geography & Economy:</strong> Nestled in a deep valley, the city is surrounded by the <strong>White-Lion-Woods</strong>, Its economy is not based on common trade, but on the creation and export of rare magical scrolls, enchanted items, and strange potions, all powered by the faint energy of the Starlight Crystal beneath the city.</p>
    
    <p><strong>Culture & Factions:</strong> Due to the Sickness, the populace is quiet and secretive, communicating through sign language, written notes, and for the magically gifted, quiet telepathy. This has made them exceptionally observant. While the <strong>Arcane Council</strong> is the official power, the <strong>Silent Hand</strong> (a thieves' guild that steals secrets, not gold) operates with impunity. A devout faction, the <strong>Luminous Seekers</strong>, believes the Sickness is a divine test and seeks to "purify" the city's "unworthy" knowledge.</p>
  </div>

  <div class="section">
    <h2>City Districts</h2>
    
    <h3>The Crystal Core</h3>
    <p>The city's center, built directly above the Starlight Crystal. This is where the Arcane Council's tower, the <strong>Aetherium</strong>, scrapes the sky, its crystalline peak glowing with contained power. The streets are clean, magically lit, and eerily silent. It's home to the city's elite mages, scholars, and the Council Guard.</p>

    <h3>The Alchemist's Quarter</h3>
    <p>A district choked with the strange-smelling, colorful fumes of potion breweries and arcane forges. This is the economic heart of Lythorien, where rival alchemists and artificers compete to create magical wonders. The air is thick with the bubble of cauldrons and the occasional, muffled *bang* of a failed experiment.</p>

    <h3>The Hush (White-Lion-Woods Slums)</h3>
    <p>The sprawling outer ring of the city, where the streets blur with the edge of the White-Lion-Woods. The poorest citizens live here in homes built into and from the giant, hollowed-out trees. The Whispering Sickness is strongest here, and the alleys are a disorienting cacophony of disembodied voices. The <strong>Silent Hand</strong> is rumored to use the echo-filled alleys as its headquarters.</p>
  </div>
  <div class="section">
    <h2>Key NPCs</h2>
    <div class="npc">
      <strong>Archmage Danma</strong> — The cold, calculating, and soft-spoken leader of the Arcane Council. He claims to be dedicating all the city's resources to finding a cure for the Whispering Sickness, but he spends most of his time in locked chambers within the Aetherium.
    </div>
    <div class="npc">
      <strong>"Echo"</strong> — The mysterious guildmaster of the Silent Hand. No one has seen Echo; they communicate only through stolen notes, "borrowed" voices (using the Sickness), and cryptic messages left in public places. They seem to want to undermine the Arcane Council's monopoly on knowledge.
    </div>
    <div class="npc">
      <strong>Lyra, the Luminous Seeker</strong> — A charismatic and zealous priestess who leads the Luminous Seekers. She preaches in the Hush, claiming the Sickness is a divine trial to purge the city of forbidden knowledge. She openly opposes Danma's "blasphemous" attempts at a cure.
    </div>
  </div>


  <div class="section dm-screen">
    <h2>DM Screen (Secrets)</h2>
    <button id="dmButton">Show DM Notes</button>

    <div id="dmNotesContainer" style="display:none; background-color:#1a1a1d; border:1px solid gold; padding:15px; margin-top:10px; color:#E0D8B0;">
        <pre id="dmNotesContent" style="white-space: pre-wrap; font-family: 'Merriweather', serif;"></pre>
    </div>

    <div id="encryptedData" style="display:none;">U2FsdGVkX19YWVystOUQBtDDy4rMMZKfoZQ09Ld+gTiJc3ARdcpJ6CJly3JyUnlLS8rHzuZTINomihbkKiXUaAfUiMqh8BT+l1WOE4xxjwrs41h6auQannnvHV8G5OTkbJG8+80vQALWvgB/hxlpvBBQDLe67oxIXRQHfDmfmSObKyfxAWkNq2TnMnFBpvFFk5IWbehmelcndNwvRzrEXL77ITeG6WHP8Ufl7m7paiLhn6bw7whrssqFnui1HQ/DsQwLuAe2PpwsNZFPbdC+68XBdiUZGB5CYX/ZqI3xoSdso9Cml629qoFKrRC7mKySzsiNs9vZHsacvgnIoFez2+ffITdBs13NYMIaGTV+RiVGQukzlME8u76Vk2OufZgFVPT2wP4I5cEvOeMmpiWDmzjOck5JoRaTXruxw9hVXpy96tVxlVId9nBjEZPQo9RqQjsNQFrSRQccQzdqJ41vXq3l1TW0sJ+WVLa9ZVFrld9vISXrzIp24gQAhTwmC1z81Bc7qBaysZkX6fSdxPn0/Nj9jwDU6IHwC5QXCby5dV+jPxXwHthJ4CYKCm/omxbQnxvW/LaraEhFXfv114MqXAp1yGmNuhQOrguOnEGZqtgRAi20kqnwstTkEUPraUa7apTZo1T2nrF9+KQeqpxkH/fxZp2BbkRAnpyavR8a8IHVVuFBqqMSzkUjSU/oSUvmUsS5Krne6MbGSIitVOMJtrbHKcAxHctzRNoqAokX1dM=</div>
  </div>


  <div class="section notes">
    <h2>Player Notes</h2>
    <textarea id="notes" placeholder="Write notes here..."></textarea>
    <button id="saveNotes">Save Notes</button>
  </div>

  <a href="../map/map.html" class="back-link">⬅ Back to Campaign Map</a>


  <script>

    // START: ADD THIS DECRYPTION LOGIC
  const dmButton = document.getElementById('dmButton');

  dmButton.addEventListener('click', () => {
    const password = prompt('Enter DM Password:'); // e.g., "Lythorien"
    if (!password) return;

    const encryptedText = document.getElementById('encryptedData').innerText;
    if (!encryptedText.trim() || encryptedText === "[YOUR_ENCRYPTED_STRING_HERE]") {
        alert('No encrypted notes found on this page. Please ask the DM to add them.');
        return;
    }

    try {
        // Try to decrypt
        const bytes = CryptoJS.AES.decrypt(encryptedText, password);
        const decryptedNotes = bytes.toString(CryptoJS.enc.Utf8);

        if (decryptedNotes) {
            // Success!
            document.getElementById('dmNotesContent').innerText = decryptedNotes;
            document.getElementById('dmNotesContainer').style.display = 'block';
            dmButton.style.display = 'none'; // Hide button
        } else {
            // Password was wrong, but didn't cause an error
            alert('Wrong Password!');
        }
    } catch (e) {
        // Password was definitely wrong and caused an error
        alert('Wrong Password!');
        console.error(e);
    }
  });
  // END: ADD THIS DECRYPTION LOGIC

    const notesKey = 'lythorien_notes';
    const textarea = document.getElementById('notes');
    const saveButton = document.getElementById('saveNotes');

    textarea.value = localStorage.getItem(notesKey) || '';

    saveButton.addEventListener('click', () => {
      localStorage.setItem(notesKey, textarea.value);
      alert('Notes saved!');
    });
  </script>
</body>
</html>