<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Oakenfort</title>
  <link rel="stylesheet" href="../stylesheet.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
  <style>
    .notes textarea {
      width: 100%;
      height: 250px;
      background-color: #1A1A1D;
      color: #E0D8B0;
      border: 1px solid #3A3A3F;
      border-radius: 5px;
      padding: 15px;
      font-family: 'Merriweather', serif;
      font-size: 1em;
      resize: vertical;
    }

    header {
      background-color: #1A1A1D;
      color: gold;
      padding: 15px;
      text-align: center;
    }

    header ul {
      list-style-type: none;
      margin: 0;
      padding: 0;
    }

    header li {
      display: inline;
      margin: 0 15px;
    }

    header a {
      color: gold;
      text-decoration: none;
      font-weight: bold;
    }

    header a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>
    <h1>The Ardent Empire</h1>
    <nav>
      <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="../players.html">Player Characters</a></li>
        <li><a href="../cities.html">Locations</a></li>
        <li><a href="../map/map.html">Map</a></li>
        <li><a href="../travel-calculator.html">Travel calc</a></li>
      </ul>
    </nav>
  </header>

  <div class="city-banner">
    <h1>Oakenfort</h1>
    <p><em>The Heart of the Harvest</em></p>
  </div>

  <div class="city-content">
    <div class="section">
      <h2>Lore</h2>
      <p>Oakenfort is a cheerful, bustling village, famous across the land for its ales. The "Fort" in its name refers to the original, sturdy oak palisade its founders built to protect it from the dangers of the surrounding woods, a defense that still stands today. The "Oaken" refers to the ancient trees that supply that palisade and, more importantly, fuel the fires of its famous breweries.</p>
      
      <p><strong>History & Governance:</strong> The town is governed not by a noble, but by a beloved <strong>Village Elder</strong>. The current elder is the portly and kind halfling, <strong>Milo Greenbottle</strong>. He oversees the town's day-to-day affairs, but his most important duty is acting as the master of ceremonies for the annual harvest festival, "Grogger's Fest."</p>
      
      <p><strong>Geography & Economy:</strong> Oakenfort is nestled in a fertile clearing, surrounded by dense woods. Its economy is almost entirely dependent on its legendary brewing. The highlight is "Old Grogger," a famously strong and sweet ale that is the centerpiece of its harvest festival and its most valuable export. The secret recipe is guarded by the Brewers' Guild.</p>
      
      <p><strong>Culture & Factions:</strong> The culture is one of community, celebration, and hard work. The entire village pitches in for the harvest and Grogger's Fest. During the festival, the village also hosts a legendary drinking contest. The winner is awarded <strong>"The Saviors' Tankard,"</strong> a trophy depicting the four heroes who once saved the festival from a band of goblins: a Topaz Dragonborn (Brother Rock), a Hobgoblin (Auknid Von Brant), an Elephantine (Quintorius Tusk), and a Rock Gnome (Godzul Figiteer).</p>
    </div>

    <div class="section">
      <h2>City Districts</h2>
      
      <h3>The Town Square</h3>
      <p>The open, grassy heart of Oakenfort. This is where all public life happens, from daily markets to the boisterous "Grogger's Fest." It is lined with food stalls, game pitches, and a permanent wooden platform where the Village Elder addresses the townsfolk. A small, carved statue depicting the "Four Saviors" of the festival stands in the center of the square, a popular meeting spot.</p>

      <h3>The Brewhouses</h3>
      <p>A district that is a source of both pride and a constant, sweet, malty aroma. This area is home to the various breweries, malthouses, and cooperages that make the village's famous ales. The centerpiece is the Greenbottle Brewery, a community-owned building where "Old Grogger" is crafted under lock and key.</p>

      <h3>The Dells</h3>
      <p>The primary residential area, a cozy neighborhood of halfling-holes dug into a series of rolling hills and small, well-kept cottages for the human residents. It is a quiet, peaceful district of gardens and winding paths.</p>

      <h3>The Old Palisade</h3>
      <p>The original "fort" of Oakenfort. This sturdy, tall wall of oak logs encircles the town, with watchtowers posted at intervals. It is constantly patrolled by the Town Watch, who protect the town from the dangers of the surrounding woods and ensure trade can flow safely.</p>
    </div>
    
    <div class="section">
      <h2>Key NPCs</h2>
      <div class="npc">
        <strong>Milo Greenbottle</strong> — A portly and kind halfling who serves as the Village Elder. He is the heart of the community, beloved by all, and the official Master of Grogger's Fest. He holds a deep reverence for the "Four Saviors" who rescued his festival.
      </div>
      <div class="npc">
        <strong>Master Brewer Tilda</strong> — The current head of the Brewers' Guild and the keeper of the "Old Grogger" recipe. She is a stern, no-nonsense dwarf who takes brewing more seriously than religion. She is arguably the most powerful person in town, as the entire economy rests on her shoulders.
      </div>
      <div class="npc">
        <strong>Captain Elara</strong> — The no-nonsense human leader of the Oakenfort Town Watch. She is responsible for the safety of the town, the palisade, and the valuable ale caravans. She has little patience for festival frivolity but understands it's the lifeblood of the town.
      </div>
    </div>


    <div class="section dm-screen">
      <h2>DM Screen (Secrets)</h2>
      <button id="dmButton">Show DM Notes</button>

      <div id="dmNotesContainer" style="display:none; background-color:#1a1a1d; border:1px solid gold; padding:15px; margin-top:10px; color:#E0D8B0;">
          <pre id="dmNotesContent" style="white-space: pre-wrap; font-family: 'Merriweather', serif;"></pre>
      </div>

      <div id="encryptedData" style="display:none;">U2FsdGVkX1+WsjNeNQOUrBeRdp1/1L+GwJ+1bA/aMR9QKOcU5S6COaCqy0IFRL5c</div>
    </div>

    <div class="section notes">
      <h2>Player Notes</h2>
      <textarea id="notes" placeholder="Write notes here..."></textarea>
      <button id="saveNotes">Save Notes</button>
    </div>

    <a href="../map/map.html" class="back-link">⬅ Back to Campaign Map</a>
  </div>

  <script>

      // START: ADD THIS DECRYPTION LOGIC
  const dmButton = document.getElementById('dmButton');

  dmButton.addEventListener('click', () => {
    const password = prompt('Enter DM Password:');
    if (!password) return;

    const encryptedText = document.getElementById('encryptedData').innerText;
    if (!encryptedText.trim()) {
        alert('No encrypted notes found on this page.');
        return;
    }

    try {
        // Try to decrypt
        const bytes = CryptoJS.AES.decrypt(encryptedText, password);
        const decryptedNotes = bytes.toString(CryptoJS.enc.Utf8);

        if (decryptedNotes) {
            // Success!
            document.getElementById('dmNotesContent').innerText = decryptedNotes;
            document.getElementById('dmNotesContainer').style.display = 'block';
            dmButton.style.display = 'none'; // Hide button
        } else {
            // Password was wrong, but didn't cause an error
            alert('Wrong Password!');
        }
    } catch (e) {
        // Password was definitely wrong and caused an error
        alert('Wrong Password!');
        console.error(e);
    }
  });
  // END: ADD THIS DECRYPTION LOGIC

    const notesKey = 'oakenfort_notes';
    const textarea = document.getElementById('notes');
    const saveButton = document.getElementById('saveNotes');

    textarea.value = localStorage.getItem(notesKey) || '';

    saveButton.addEventListener('click', () => {
      localStorage.setItem(notesKey, textarea.value);
      alert('Notes saved!');
    });
  </script>
</body>
</html>